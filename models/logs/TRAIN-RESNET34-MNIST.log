epoch:0, train_loss:0.19558506276418802, valid_loss:0.15576226665829931, valid_accuracy:95.38333333333334
train_cm:
[[3965    7   20   13    3   19   43   17   36   20]
 [   2 4657   37   18   13   12   10   25   21    4]
 [  30   30 3883   54   16    5   20   54   46    9]
 [  17   15   75 3987    2   69    3   34   45   21]
 [  10   18   17    1 3853    5   45   21   14  115]
 [  20   14   11   65   12 3542   37   12   52   19]
 [  34   13   13    6   37   43 4003    2   27    2]
 [  12   24   54   35   24    7    2 4066   10   96]
 [  27   33   43   43   19   48   33   10 3713   71]
 [  31   13    6   25   94   28    4   88   51 3870]]

valid_cm:
[[1675    0   96    0    0    0    5    0    4    0]
 [   0 1860   56    0   10    0    3    0   14    0]
 [   0    0 1811    0    0    0    0    0    0    0]
 [   0    0   95 1743    1    8    0    0   14    2]
 [   0    0   12    0 1723    0    0    1    5    2]
 [   2    0   16    4    3 1588   18    1    3    2]
 [   1    0    9    0    2    0 1725    0    1    0]
 [   0    2  159    0   21    0    0 1750    0    3]
 [   1    1   37    2    3    1    5    0 1757    4]
 [   1    0   69    1  112    1    1   10    7 1537]]
epoch:1, train_loss:0.07686020910762575, valid_loss:0.14610957417716366, valid_accuracy:95.68888888888888
train_cm:
[[4091    2    5    2    0    6   22    1   10    4]
 [   1 4736   18    6    7    1    3   12   11    4]
 [   4   10 4054   21    8    0    4   23   18    5]
 [   4    4   25 4155    1   32    1   17   18   11]
 [   2    9    6    0 4022    1   17    8    3   31]
 [   6    2    1   25    3 3694   20    3   23    7]
 [  23    7    1    2   12   23 4097    0   15    0]
 [   4    7   24   11   11    8    0 4231    6   28]
 [  12    6   20   22    5   20   22    4 3898   31]
 [   9    5    0    8   34   13    0   28   25 4088]]

valid_cm:
[[1736    2   27    4    0    1    0    3    7    0]
 [   0 1929    6    3    0    0    0    5    0    0]
 [   0    2 1797    2    0    0    0   10    0    0]
 [   0    0   13 1834    0    2    0   13    1    0]
 [   0    3   79    0 1641    0    1    2   15    2]
 [   0    1    5   20    0 1558    2   35   15    1]
 [   0    5   39    6    0   18 1652    0   18    0]
 [   0    5   15    1    4    0    0 1910    0    0]
 [   0    4   49   43    0    5    0   18 1690    2]
 [   3    0   92   24   52    4    0   66   21 1477]]
epoch:2, train_loss:0.05794322785256564, valid_loss:0.07321048630995955, valid_accuracy:97.94444444444444
train_cm:
[[4110    4    1    2    0    1   14    2    5    4]
 [   2 4744    9    5    8    2    4   15   10    0]
 [   3    7 4078   20    2    0    2   21   11    3]
 [   2    3   21 4184    0   25    0   13   12    8]
 [   2    6    7    0 4027    0    8    8    7   34]
 [   2    2    2   21    2 3711   16    0   22    6]
 [  11    5    2    2    9   15 4129    0    7    0]
 [   1   12   21   10   12    0    0 4247    2   25]
 [   3   10   12   13    5   19   10    4 3945   19]
 [   8    2    2    7   32   11    2   27   17 4102]]

valid_cm:
[[1772    0    1    1    0    0    4    0    2    0]
 [   0 1941    1    0    0    0    0    1    0    0]
 [   3    2 1803    0    0    1    0    0    2    0]
 [   0    1   26 1824    0    1    0    0   10    1]
 [   0    8    1    0 1725    0    4    1    0    4]
 [   5    3    1    7    1 1607    6    0    7    0]
 [   2    3    3    0    0    3 1719    0    8    0]
 [   0    7   23    4    7    1    0 1892    1    0]
 [  21   12   32    1    6    5    1    5 1720    8]
 [  25    1    9    3   27    4    0   40    3 1627]]
epoch:3, train_loss:0.04989537401932831, valid_loss:0.06903779758999105, valid_accuracy:98.18333333333334
train_cm:
[[4111    1    4    0    1    7   11    2    3    3]
 [   1 4761   10    3    3    2    2   13    3    1]
 [   6   11 4085   15    4    0    1   14   10    1]
 [   1    3   18 4191    1   23    1    8   17    5]
 [   2    3    5    0 4020    0   10    8    5   46]
 [   4    2    1   18    0 3718   17    2   13    9]
 [  13    4    4    0    6   11 4128    0   12    2]
 [   1   12   16    4    9    4    0 4259    4   21]
 [   5    6    9   12    5   11   12    3 3965   12]
 [   7    2    1    3   40   10    1   22   10 4114]]

valid_cm:
[[1771    0    2    2    0    0    4    0    1    0]
 [   0 1917    6    3    0    1    5    7    3    1]
 [   2    0 1804    1    0    0    0    3    0    1]
 [   0    0   17 1835    0    1    0    5    2    3]
 [   0    2    2    0 1682    0    6    4    4   43]
 [   9    0    2   15    0 1548   43    1    9   10]
 [   2    0    3    0    0    0 1732    0    1    0]
 [   0    4    3    1    3    0    0 1922    0    2]
 [   8    3   13    7    3    0    7    5 1756    9]
 [   7    0    1    3    1    0    0   20    1 1706]]
epoch:4, train_loss:0.04226819961083718, valid_loss:0.08873239466061822, valid_accuracy:97.83333333333333
train_cm:
[[4105    0    3    1    0    6   18    2    6    2]
 [   0 4760    6    3    6    2    1   16    4    1]
 [   4    6 4099    7    2    2    3   17    7    0]
 [   3    3   12 4212    0   17    0    5    8    8]
 [   0    3    2    0 4047    1    9    7    4   26]
 [   5    3    0   15    0 3731   13    1   10    6]
 [  20    4    3    0    7    8 4126    0   11    1]
 [   1   12   15    2    8    1    0 4274    3   14]
 [   5    5   12   10    2   13    9    3 3969   12]
 [   2    3    1    4   21   10    0   16   14 4139]]

valid_cm:
[[1776    0    0    1    0    0    0    0    2    1]
 [   0 1937    1    0    0    4    0    0    1    0]
 [   2   23 1756    1    4    0    2   10   13    0]
 [   0    1    5 1833    4    1    0    3   12    4]
 [   0   11    0    0 1730    0    0    1    0    1]
 [   2    2    0    7   15 1585    5    1   17    3]
 [   0    1    0    0    2    0 1723    0   12    0]
 [   0   18    1    2   19    0    0 1886    1    8]
 [   1   11    2    0   27    3    2    1 1754   10]
 [   2    8    0    1   86    1    0    7    4 1630]]
epoch:5, train_loss:0.0403686370558844, valid_loss:0.07177332474301895, valid_accuracy:98.37777777777778
train_cm:
[[4120    0    6    0    1    1   11    0    1    3]
 [   0 4763   13    3    3    1    1   11    2    2]
 [   6   13 4085   11    4    0    2   15    9    2]
 [   0    0   10 4221    0   18    0    4    9    6]
 [   1    6    5    1 4047    0    4    7    2   26]
 [   2    1    2   13    1 3734   12    1   11    7]
 [   8    0    1    0    9   12 4144    0    6    0]
 [   1   10    6    4    5    1    0 4284    2   17]
 [   3    3    8    7    6    9    6    2 3985   11]
 [   5    4    1    5   23    9    0   18   16 4129]]

valid_cm:
[[1743    7   21    0    3    1    2    0    0    3]
 [   0 1941    0    0    0    0    0    2    0    0]
 [   0    3 1806    0    0    0    0    1    1    0]
 [   0    2   14 1830    0    9    0    1    2    5]
 [   0    5    0    0 1724    0    0    1    3   10]
 [   2    3    1    3    0 1614    5    0    0    9]
 [   0    3    5    1    4    2 1721    0    2    0]
 [   0    8   19    1    8    0    0 1892    0    7]
 [   8   15   15    5    0   13    6    2 1718   29]
 [   0    3    0    1    7    0    0    9    0 1719]]
epoch:6, train_loss:0.032444353877386714, valid_loss:0.07436135696603899, valid_accuracy:97.91111111111111
train_cm:
[[4120    2    1    1    0    4    7    1    6    1]
 [   0 4766    3    2    4    0    0   14    9    1]
 [   3    4 4105    6    1    1    1   14   10    2]
 [   0    2   10 4222    0   14    1    6    9    4]
 [   1    7    1    0 4055    0    5    8    4   18]
 [   4    0    1    9    0 3740   10    2   10    8]
 [   6    0    2    1    5    9 4153    0    4    0]
 [   0    8   11    4    5    1    0 4289    2   10]
 [   4    7    7    7    2    8    4    2 3989   10]
 [   2    5    1    7   14    7    0   13    8 4153]]

valid_cm:
[[1772    0    1    0    2    0    0    0    0    5]
 [   0 1921    3    0   14    0    1    4    0    0]
 [   5    0 1751    1   23    0    0   29    1    1]
 [   1    0    6 1846    0    1    0    2    4    3]
 [   0    1    0    0 1733    0    0    1    0    8]
 [   9    1    2    8    3 1601    2    4    3    4]
 [  19    1    1    1   22    0 1693    1    0    0]
 [   0    6    3    2    8    0    0 1914    0    2]
 [  54    8    3    6    3   16    2   12 1685   22]
 [   3    0    0    3   14    1    0   10    0 1708]]
epoch:7, train_loss:0.03327447744695923, valid_loss:0.07164310847560987, valid_accuracy:98.0111111111111
train_cm:
[[4125    2    2    1    1    0    6    1    3    2]
 [   2 4765    4    4    2    1    4   12    5    0]
 [   3    6 4107    4    1    0    3   13    6    4]
 [   0    2    7 4219    0   18    0    5   14    3]
 [   2    5    0    0 4063    0    5    2    0   22]
 [   2    1    0   17    0 3742   13    0    4    5]
 [   6    3    5    0   10   10 4139    0    7    0]
 [   0   11   16    3    5    1    0 4278    1   15]
 [   4    7    6    8    0    8    4    3 3990   10]
 [   4    1    1    3   17    4    1   17    3 4159]]

valid_cm:
[[1758    0    3    0    8    4    6    0    1    0]
 [   0 1928   13    0    2    0    0    0    0    0]
 [   1    1 1807    0    0    0    0    0    2    0]
 [   2    0   19 1824    0    6    0    0   10    2]
 [   0    3    0    0 1735    0    2    1    1    1]
 [   1    0    1    5    1 1620    8    0    1    0]
 [   0    0    2    0    0    6 1730    0    0    0]
 [  10   14   17    1   21   11    1 1837   19    4]
 [   7    2    6    0    0    5    6    0 1785    0]
 [   4    1    4    5   72   10    0    2   23 1618]]
save model successfully
best epoch:  3
best valid loss:  0.06903779758999105
time cost: 293.83
