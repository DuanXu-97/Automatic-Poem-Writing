epoch:0, train_loss:0.2533597821707146, valid_loss:0.1264836000450326, valid_accuracy:96.52777777777777
train_cm:
[[3943   11   29    6    5   35   51    9   39   15]
 [   7 4648   40   22   14   16   12   20   16    4]
 [  28   36 3812   73   31    8   22   65   61   11]
 [  12   19   74 3951    3   74    8   47   55   25]
 [  15   20   27    5 3779   18   48   31   30  126]
 [  29   17   11   59   11 3473   53    9   67   55]
 [  51   26   23    2   53   49 3926    3   44    3]
 [   9   17   55   37   31    9    7 4030   13  122]
 [  35   21   70   69   29   67   59   18 3583   89]
 [  32    7   17   20  126   53    9  114   64 3768]]

valid_cm:
[[1757    1    9    2    0    0    4    1    4    2]
 [   0 1924    4    1    1    0    2    1    0   10]
 [   2    3 1795    6    0    0    1    3    1    0]
 [   0    0   25 1782    0   15    0    5   25   11]
 [   1    2    4    0 1494    0    4   10    1  227]
 [   2    2    2    7    0 1591    7    0   16   10]
 [   2    2    2    0    1    4 1721    0    6    0]
 [   0    4   15    1    5    0    0 1868    0   42]
 [   3    7   32    3    5    4    3    1 1740   13]
 [   9    0    1    4    3    5    0    6    8 1703]]
epoch:1, train_loss:0.09017402803187956, valid_loss:0.8058408449489806, valid_accuracy:89.70555555555555
train_cm:
[[4088    2   14    0    2    4   23    1    3    6]
 [   2 4729   14   10   12    1    7   16    6    2]
 [  11   14 4040   24    6    0    3   27   21    1]
 [   0    7   24 4162    0   25    0   18   21   11]
 [   2   13    5    0 3985    2   12   13    7   60]
 [   8    3    3   19    2 3686   25    3   18   17]
 [  19    5    3    0   17   20 4098    0   17    1]
 [   2    9   16   13   19    2    0 4233    6   30]
 [  11   11   20   20   11   25   20    6 3886   30]
 [  14    6    2    7   41   22    3   31   34 4050]]

valid_cm:
[[1771    2    2    0    0    0    1    0    4    0]
 [   0 1936    1    0    2    0    2    1    1    0]
 [   4   27 1739    8    0    0    0    2   31    0]
 [   3   11    4 1797    1   19    0    2   25    1]
 [   0    4    2    0  500    0    1    7 1224    5]
 [   4    0    0    2    0 1586    5    1   36    3]
 [   9    1    1    0    4    3 1695    0   25    0]
 [   0    8    3    2    2    1    0 1910    9    0]
 [   3    4    1    0    0    2    0    2 1798    1]
 [   6    1    4   16   45    5    0  177   70 1415]]
epoch:2, train_loss:0.1134036128129954, valid_loss:0.09148370333227279, valid_accuracy:97.23333333333333
train_cm:
[[4076    5    4    0    6   10   26    1    9    6]
 [   2 4716   24    8   17    3    3   16    5    5]
 [  10   23 4020   21   12    2    3   36   16    4]
 [   1    3   22 4140    1   28    1   19   31   22]
 [   4   11   13    2 3932    1   22   20   19   75]
 [   5    3    0   27    5 3675   26    3   29   11]
 [  27    8    0    1   18   22 4084    0   20    0]
 [   1   18   28   17   20    3    0 4198    5   40]
 [   8    5   16   18   15   21   27    9 3893   28]
 [  12    5    2   11   54   19    1   49   26 4031]]

valid_cm:
[[1701    0   11    1    0    8   36    1   20    2]
 [   0 1922   10    1    1    1    1    3    4    0]
 [   0    2 1777    1    0    2    0   15   14    0]
 [   0    0   11 1726    0  106    0    4   10    6]
 [   0    2    6    0 1713    0    3    7    3    9]
 [   0    1    1    1    1 1619    6    0    4    4]
 [   0    2    6    1    1   11 1698    0   19    0]
 [   0    7    4    1    7    0    0 1909    2    5]
 [   1    2    4    1    3   20    0    4 1770    6]
 [   3    1    1    1   26   20    1   16    3 1667]]
epoch:3, train_loss:0.12925207500361605, valid_loss:0.08540528801976566, valid_accuracy:97.53333333333333
train_cm:
[[4043    5   13    2    0   19   35    3   17    6]
 [   3 4706   27    7    9    4   10   21   11    1]
 [  12   18 4021   23    6    0    8   26   26    7]
 [   4    8   28 4145    0   25    5   13   23   17]
 [   4    8    7    0 3969    1   24   13    9   64]
 [  18    4    2   26    1 3646   38    4   28   17]
 [  27    8   10    4   16   36 4048    0   31    0]
 [   5   17   28   12   20    6    0 4196    7   39]
 [  11   14   21   19   12   37   24   10 3864   28]
 [   9    4    5   13   41   18    1   42   30 4047]]

valid_cm:
[[1775    0    4    0    0    0    0    0    0    1]
 [   1 1938    2    0    0    0    0    1    1    0]
 [   7   11 1772    9    0    0    1    3    8    0]
 [   2    0    3 1817    0   10    0    2   28    1]
 [   0    6    1    0 1714    0    0    5    9    8]
 [  25    1    0    3    0 1578    8    1   20    1]
 [  21    2    2    1    3    1 1701    0    7    0]
 [   3   12    5   18    2    1    0 1891    2    1]
 [  24    6    2    1    0    5    0    6 1767    0]
 [  12    1    3    2   27   18    0   49   24 1603]]
epoch:4, train_loss:0.06165762498260351, valid_loss:0.05913046265932474, valid_accuracy:98.43333333333334
train_cm:
[[4100    3    4    1    0    4   17    2    7    5]
 [   2 4745   17    7    5    1    2   14    6    0]
 [   7   14 4070   16    3    0    0   18   17    2]
 [   3    3   17 4194    0   21    0   10   16    4]
 [   3    4    4    1 4020    1    9   11    9   37]
 [   5    2    1   11    0 3720   19    3   15    8]
 [  17    7    1    1   11   10 4125    0    8    0]
 [   1   10   17    7   12    0    0 4264    4   15]
 [   5    8   15   11    8   17   13    6 3934   23]
 [   9    4    1    3   31    9    2   20   16 4115]]

valid_cm:
[[1762    0    6    1    0    0    2    1    7    1]
 [   0 1934    1    1    1    0    2    4    0    0]
 [   1   10 1790    0    0    0    2    6    2    0]
 [   0    0   14 1826    0    1    0   12    7    3]
 [   0    5    1    0 1698    0    0    1    2   36]
 [   1    0    1   35    0 1570   11    0   12    7]
 [   0    0    1    0    2    1 1731    0    3    0]
 [   0    3    1    0    2    0    0 1924    0    5]
 [   2    5    3    2    1    3    4    5 1779    7]
 [   4    1    2    4    6    2    0   14    2 1704]]
epoch:5, train_loss:0.04806962755864523, valid_loss:0.061157918132260354, valid_accuracy:98.43888888888888
train_cm:
[[4111    2    4    0    0    4   14    0    3    5]
 [   3 4754    9    3    1    2    0   17    7    3]
 [   2    7 4094    8    2    0    2   17   11    4]
 [   1    1   15 4205    0   20    0    8   11    7]
 [   0    3    4    0 4036    1   11    7    3   34]
 [   7    0    0   16    0 3728   13    3   13    4]
 [  12    1    1    0   10    9 4133    0   14    0]
 [   1   12   20    3    7    0    0 4266    2   19]
 [   5    7    7   11    4   16   12    3 3962   13]
 [   7    2    1    6   34    7    2   24   14 4113]]

valid_cm:
[[1764    1    5    2    1    0    2    0    2    3]
 [   0 1938    1    0    0    0    0    4    0    0]
 [   0    6 1788    0    3    0    1   10    3    0]
 [   0    1   23 1819    0    9    0    4    4    3]
 [   0    5    0    0 1722    0    0    2    6    8]
 [   0    0    1    6    0 1615    3    1    5    6]
 [   1    3    1    0    5   19 1703    0    6    0]
 [   0    4    2    0    4    0    0 1924    0    1]
 [   2    9    7    1    0    7    0    3 1772   10]
 [   0    4    4    2   14    3    0   38    0 1674]]
epoch:6, train_loss:0.038453430881443075, valid_loss:0.04080924387122933, valid_accuracy:98.77777777777777
train_cm:
[[4116    3    2    2    0    2   12    0    3    3]
 [   1 4758   12    2    5    1    2   13    5    0]
 [   4    9 4096    8    2    0    0   16    9    3]
 [   0    0   15 4212    0   19    0    9    8    5]
 [   1    4    3    0 4054    0    5    6    2   24]
 [   3    0    1   13    0 3731   16    0   10   10]
 [  10    3    1    0    8   10 4139    0    9    0]
 [   1   11    8    7    6    2    0 4286    2    7]
 [   4    3   11    4    3    9    9    2 3984   11]
 [   3    2    1    5   24   11    1   14    5 4144]]

valid_cm:
[[1758    0    1    1    3    0   14    1    0    2]
 [   0 1928   10    2    0    0    0    3    0    0]
 [   2    0 1800    2    1    0    0    3    3    0]
 [   0    0   10 1836    0    9    0    1    5    2]
 [   0    2    1    0 1730    0    0    1    1    8]
 [   1    1    0    6    0 1617    8    0    2    2]
 [   0    2    4    0    2    1 1729    0    0    0]
 [   0    4    1    2    6    0    0 1919    0    3]
 [   3    2    1    2    4    4   16    2 1770    7]
 [   3    0    0    6   18    4    0   14    1 1693]]
epoch:7, train_loss:0.036425696986428266, valid_loss:0.05203724501931919, valid_accuracy:98.6
train_cm:
[[4119    2    3    1    0    1    7    1    3    6]
 [   3 4756    8    4    3    0    1   16    7    1]
 [   4    7 4099   10    1    0    1   15    7    3]
 [   1    4   11 4212    0   16    2    7   11    4]
 [   0    4    2    1 4056    0    6   10    1   19]
 [   2    0    1   11    1 3746    9    1    9    4]
 [   7    2    0    1    4    8 4148    0   10    0]
 [   0    9   15    5    7    1    0 4281    2   10]
 [   2    6    9    9    5   10    8    4 3980    7]
 [   4    3    2    2   20    5    1   13    9 4151]]

valid_cm:
[[1754    2    8    1    3    1    0    2    5    4]
 [   0 1933    3    1    0    0    2    2    2    0]
 [   0    1 1793    3    0    0    1    8    5    0]
 [   0    0    4 1853    0    4    0    0    2    0]
 [   0    5    0    0 1720    0    0    1    3   14]
 [   0    0    0   17    0 1612    5    1    1    1]
 [   2    1    3    1    3    6 1715    0    7    0]
 [   0    7    8    5    3    0    0 1910    1    1]
 [   1    2    0    7    0   25    0    4 1765    7]
 [   0    0    0   17    7    3    0   17    2 1693]]
epoch:8, train_loss:0.037059935011094336, valid_loss:0.041882454120415344, valid_accuracy:98.82777777777778
train_cm:
[[4121    2    5    0    0    4   10    0    1    0]
 [   1 4769    4    1    3    2    4   11    4    0]
 [   3    5 4104    7    3    0    1   14    9    1]
 [   2    0    7 4228    0   11    0    8    8    4]
 [   1    3    3    0 4055    1    6    6    2   22]
 [   2    1    1   13    1 3741   10    1   10    4]
 [  15    3    2    0    5    7 4140    0    8    0]
 [   1    9   17    4    4    2    0 4285    0    8]
 [   3    4    5   11    6   17    7    0 3975   12]
 [   1    3    1    2   18    6    0   12   13 4154]]

valid_cm:
[[1765    0    4    1    0    0    4    1    4    1]
 [   0 1938    0    0    0    0    0    5    0    0]
 [   0    9 1786    6    0    0    2    4    4    0]
 [   0    0    6 1847    0    2    0    3    3    2]
 [   0    3    0    0 1723    0    0    1    2   14]
 [   1    4    3   13    0 1596    7    2    7    4]
 [   0   15    1    0    1    1 1712    0    8    0]
 [   0    6    2    2    6    0    0 1912    0    7]
 [   2    6    4    2    1    2    0    0 1790    4]
 [   0    1    1    2    5    0    0    8    2 1720]]
epoch:9, train_loss:0.09987289112633942, valid_loss:0.05362176142157398, valid_accuracy:98.41111111111111
train_cm:
[[4088    5    5    2    1    7   19    3    8    5]
 [   0 4716   14    3   25    3    3   17   13    5]
 [   6   17 4051   23    8    1    3   25   13    0]
 [   3    3   21 4162    0   30    0   13   22   14]
 [   5   27   11    1 3959    0   17   11    8   60]
 [   8    9    1   25    4 3680   28    2   15   12]
 [  22   10    2    0   16   24 4089    0   15    2]
 [   3   13   17    8   15    2    0 4235    2   35]
 [   9   16   21   18    6   16   27    4 3897   26]
 [   7    6    5   15   54   14    1   35   16 4057]]

valid_cm:
[[1761    0   11    0    0    1    1    3    3    0]
 [   0 1930    2    0    4    0    3    3    1    0]
 [   0    0 1789    2    0    0    0   15    5    0]
 [   1    0    9 1809    0    8    0   10   21    5]
 [   0    2    1    0 1680    0    0    1    3   56]
 [   1    0    1    1    0 1616    5    2   10    1]
 [   1    0    2    0    4    1 1723    0    7    0]
 [   0    3    3    0    7    0    0 1915    0    7]
 [   2    2    5    0    1    3    4    1 1785    8]
 [   2    1    0    0    1    4    0   18    7 1706]]
save model successfully
best epoch:  6
best valid loss:  0.04080924387122933
time cost: 502.13
